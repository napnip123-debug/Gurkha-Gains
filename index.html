<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>PPL Workout Tracker</title>
    <meta name="description" content="Track your Push/Pull/Legs workout routine with Nepali calendar support">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PPL Tracker">
    <link rel="manifest" href="manifest.json">
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        * { font-family: 'Inter', sans-serif; }
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; }
        .app-container { max-width: 430px; margin: 0 auto; min-height: 100vh; }
        .exercise-card { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(10px); }
        .exercise-card.completed { background: rgba(34, 197, 94, 0.15); border-color: rgba(34, 197, 94, 0.3); }
        .custom-checkbox { appearance: none; width: 24px; height: 24px; border: 2px solid #6366f1; border-radius: 6px; cursor: pointer; transition: all 0.2s; }
        .custom-checkbox:checked { background: linear-gradient(135deg, #6366f1, #8b5cf6); border-color: #8b5cf6; }
        .custom-checkbox:checked::after { content: '‚úì'; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 14px; }
        .day-tab { transition: all 0.3s; }
        .day-tab.active { background: linear-gradient(135deg, #6366f1, #8b5cf6); transform: scale(1.05); }
        .progress-ring { transform: rotate(-90deg); }
        .nav-item.active { color: #8b5cf6; }
        .nav-item.active::after { content: ''; position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); width: 4px; height: 4px; background: #8b5cf6; border-radius: 50%; }
        .calendar-day { transition: all 0.2s; }
        .calendar-day.today { background: linear-gradient(135deg, #6366f1, #8b5cf6); }
        .calendar-day.has-workout { border: 2px solid #22c55e; }
        .calendar-day.completed-day { background: rgba(34, 197, 94, 0.3); }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-in { animation: slideIn 0.3s ease-out forwards; }
        .install-banner { background: linear-gradient(135deg, #059669, #10b981); animation: slideDown 0.3s ease-out; }
        @keyframes slideDown { from { transform: translateY(-100%); } to { transform: translateY(0); } }
        .install-banner.hidden { display: none; }
    </style>
</head>
<body class="text-white">
    <div id="installBanner" class="install-banner hidden fixed top-0 left-0 right-0 z-[100] px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <span class="text-2xl">üì≤</span>
            <div>
                <p class="font-semibold text-sm">Install PPL Tracker</p>
                <p class="text-xs opacity-80">Add to home screen for best experience</p>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="dismissInstall()" class="px-3 py-1.5 text-sm opacity-80 hover:opacity-100">Later</button>
            <button onclick="installApp()" class="px-4 py-1.5 bg-white text-green-600 rounded-lg text-sm font-semibold">Install</button>
        </div>
    </div>
    <div class="app-container pb-20">
        <header class="sticky top-0 z-50 bg-gradient-to-r from-indigo-600 to-purple-600 px-4 py-4 shadow-lg">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-xl font-bold">üí™ PPL Tracker</h1>
                    <p class="text-xs text-indigo-200" id="nepaliDate">Loading...</p>
                </div>
                <div class="text-right">
                    <p class="text-sm font-medium" id="englishDate"></p>
                    <p class="text-xs text-indigo-200" id="dayName"></p>
                </div>
            </div>
        </header>
        <nav class="flex justify-around bg-slate-900/80 backdrop-blur px-2 py-3 sticky top-16 z-40">
            <button onclick="showView('workout')" class="nav-item active relative text-sm font-medium px-4 py-2" id="nav-workout">üèãÔ∏è Workout</button>
            <button onclick="showView('calendar')" class="nav-item relative text-sm font-medium px-4 py-2 text-gray-400" id="nav-calendar">üìÖ Calendar</button>
            <button onclick="showView('stats')" class="nav-item relative text-sm font-medium px-4 py-2 text-gray-400" id="nav-stats">üìä Stats</button>
        </nav>
        <div id="workout-view" class="px-4 py-4">
            <div class="flex gap-2 overflow-x-auto pb-4 scrollbar-hide">
                <button onclick="selectDay(1)" class="day-tab active flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="1"><div>Day 1</div><div class="text-[10px] opacity-70">Push A</div></button>
                <button onclick="selectDay(2)" class="day-tab flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="2"><div>Day 2</div><div class="text-[10px] opacity-70">Pull A</div></button>
                <button onclick="selectDay(3)" class="day-tab flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="3"><div>Day 3</div><div class="text-[10px] opacity-70">Legs A</div></button>
                <button onclick="selectDay(4)" class="day-tab flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="4"><div>Day 4</div><div class="text-[10px] opacity-70">Push B</div></button>
                <button onclick="selectDay(5)" class="day-tab flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="5"><div>Day 5</div><div class="text-[10px] opacity-70">Pull B</div></button>
                <button onclick="selectDay(6)" class="day-tab flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="6"><div>Day 6</div><div class="text-[10px] opacity-70">Legs B</div></button>
                <button onclick="selectDay(7)" class="day-tab flex-shrink-0 px-4 py-3 rounded-xl text-xs font-semibold bg-slate-800" data-day="7"><div>Day 7</div><div class="text-[10px] opacity-70">Rest</div></button>
            </div>
            <div class="bg-gradient-to-r from-indigo-500/20 to-purple-500/20 rounded-2xl p-4 mb-4 border border-indigo-500/30">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="font-bold text-lg" id="currentDayTitle">Day 1: Push A</h3>
                        <p class="text-sm text-gray-400" id="currentDayFocus">Incline & Tricep Focus</p>
                    </div>
                    <div class="relative">
                        <svg class="progress-ring w-16 h-16">
                            <circle cx="32" cy="32" r="28" stroke="#374151" stroke-width="4" fill="none"/>
                            <circle id="progressCircle" cx="32" cy="32" r="28" stroke="url(#gradient)" stroke-width="4" fill="none" stroke-linecap="round" stroke-dasharray="176" stroke-dashoffset="176"/>
                            <defs><linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#6366f1"/><stop offset="100%" stop-color="#8b5cf6"/></linearGradient></defs>
                        </svg>
                        <span class="absolute inset-0 flex items-center justify-center text-sm font-bold" id="progressText">0%</span>
                    </div>
                </div>
            </div>
            <div id="exerciseList" class="space-y-3"></div>
        </div>
        <div id="calendar-view" class="px-4 py-4 hidden">
            <div class="bg-slate-800/50 rounded-2xl p-4 border border-slate-700">
                <div class="flex items-center justify-between mb-4">
                    <button onclick="changeMonth(-1)" class="p-2 hover:bg-slate-700 rounded-lg">‚Üê</button>
                    <div class="text-center">
                        <h3 class="font-bold text-lg" id="calendarMonth"></h3>
                        <p class="text-xs text-purple-400" id="calendarNepaliMonth"></p>
                    </div>
                    <button onclick="changeMonth(1)" class="p-2 hover:bg-slate-700 rounded-lg">‚Üí</button>
                </div>
                <div class="grid grid-cols-7 gap-1 text-center text-xs text-gray-400 mb-2">
                    <div>Sun</div><div>Mon</div><div>Tue</div><div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
                </div>
                <div id="calendarGrid" class="grid grid-cols-7 gap-1"></div>
            </div>
            <div class="mt-4 flex gap-4 text-xs">
                <div class="flex items-center gap-2"><div class="w-4 h-4 rounded bg-gradient-to-r from-indigo-500 to-purple-500"></div> Today</div>
                <div class="flex items-center gap-2"><div class="w-4 h-4 rounded border-2 border-green-500"></div> Workout Day</div>
                <div class="flex items-center gap-2"><div class="w-4 h-4 rounded bg-green-500/30"></div> Completed</div>
            </div>
        </div>
        <div id="stats-view" class="px-4 py-4 hidden">
            <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="bg-gradient-to-br from-green-500/20 to-emerald-500/20 rounded-2xl p-4 border border-green-500/30">
                    <p class="text-3xl font-bold" id="totalWorkouts">0</p>
                    <p class="text-sm text-gray-400">Workouts Done</p>
                </div>
                <div class="bg-gradient-to-br from-blue-500/20 to-cyan-500/20 rounded-2xl p-4 border border-blue-500/30">
                    <p class="text-3xl font-bold" id="currentStreak">0</p>
                    <p class="text-sm text-gray-400">Day Streak üî•</p>
                </div>
                <div class="bg-gradient-to-br from-purple-500/20 to-pink-500/20 rounded-2xl p-4 border border-purple-500/30">
                    <p class="text-3xl font-bold" id="totalExercises">0</p>
                    <p class="text-sm text-gray-400">Exercises Done</p>
                </div>
                <div class="bg-gradient-to-br from-orange-500/20 to-red-500/20 rounded-2xl p-4 border border-orange-500/30">
                    <p class="text-3xl font-bold" id="weeklyProgress">0%</p>
                    <p class="text-sm text-gray-400">This Week</p>
                </div>
            </div>
            <div class="bg-slate-800/50 rounded-2xl p-4 border border-slate-700 mb-4">
                <h3 class="font-bold mb-3">Weekly Overview</h3>
                <div class="flex justify-between">
                    <div class="text-center" id="weekDay0"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">S</span></div>
                    <div class="text-center" id="weekDay1"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">M</span></div>
                    <div class="text-center" id="weekDay2"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">T</span></div>
                    <div class="text-center" id="weekDay3"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">W</span></div>
                    <div class="text-center" id="weekDay4"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">T</span></div>
                    <div class="text-center" id="weekDay5"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">F</span></div>
                    <div class="text-center" id="weekDay6"><div class="w-8 h-8 rounded-lg bg-slate-700 mb-1"></div><span class="text-xs">S</span></div>
                </div>
            </div>
            <button onclick="resetAllData()" class="w-full py-3 bg-red-500/20 border border-red-500/30 rounded-xl text-red-400 font-medium hover:bg-red-500/30 transition">üóëÔ∏è Reset All Data</button>
        </div>
    </div>
    <script>
        const workoutData = {
            1: { title: "Day 1: Push A", focus: "Incline & Tricep Focus", exercises: [
                { name: "Inclined Smith Machine Chest Press", sets: "3", reps: "8-10", note: "Heavy compound" },
                { name: "Dips", sets: "3", reps: "10-12", note: "Lower chest/triceps" },
                { name: "Chest Fly Machine", sets: "3", reps: "12-15", note: "Peak contraction" },
                { name: "Cable Lateral Raises", sets: "4", reps: "12-15", note: "Constant tension" },
                { name: "Cable Tricep Push Downs", sets: "3", reps: "10-12", note: "Rope or straight bar" },
                { name: "EZ Bar Skull Crushers", sets: "3", reps: "8-10", note: "Long head mass builder" }
            ]},
            2: { title: "Day 2: Pull A", focus: "Vertical Pulling & Curl Focus", exercises: [
                { name: "Pull Ups", sets: "3", reps: "AMRAP", note: "Add weight if needed" },
                { name: "Lat Pulldowns", sets: "3", reps: "10-12", note: "" },
                { name: "Lat Prayers", sets: "3", reps: "12-15", note: "Straight arm pulldowns" },
                { name: "Seated Chest Supported Rows", sets: "3", reps: "10-12", note: "Upper back thickness" },
                { name: "Bayesian Bicep Curls", sets: "3", reps: "12-15", note: "Full stretch position" },
                { name: "Preacher Bicep Curls", sets: "3", reps: "10-12", note: "Short head isolation" }
            ]},
            3: { title: "Day 3: Legs A", focus: "Squat Focus + Lower Abs", exercises: [
                { name: "Squats", sets: "3", reps: "6-8", note: "Primary heavy compound" },
                { name: "Hip Thrust Machine", sets: "3", reps: "10-12", note: "Glute focus" },
                { name: "Quad Leg Extensions", sets: "3", reps: "12-15", note: "" },
                { name: "Seated Calf Raises", sets: "4", reps: "15-20", note: "" },
                { name: "Leg Raises (Core)", sets: "3", reps: "15", note: "Lower abs" },
                { name: "Inclined Treadmill Walk", sets: "1", reps: "20-30 mins", note: "Steady state cardio" }
            ]},
            4: { title: "Day 4: Push B", focus: "Machine Press & Delt Focus", exercises: [
                { name: "Hammer Chest Press", sets: "3", reps: "8-10", note: "Heavy flat press" },
                { name: "Inclined Machine Press", sets: "3", reps: "10-12", note: "Upper pec shelf" },
                { name: "Multiflight Lateral Raise Machine", sets: "4", reps: "12-15", note: "Drop sets work well" },
                { name: "Inclined Y Raises", sets: "3", reps: "12-15", note: "Lower traps/rear delts" },
                { name: "Cable Tricep Extension", sets: "3", reps: "12-15", note: "Overhead - long head" }
            ]},
            5: { title: "Day 5: Pull B", focus: "Horizontal Rowing & Brachialis", exercises: [
                { name: "Seated Cable Rows", sets: "3", reps: "10-12", note: "" },
                { name: "Inclined DB Chest Supported Rows", sets: "3", reps: "10-12", note: "No lower back strain" },
                { name: "Lat Pulldowns (Variation)", sets: "3", reps: "10-12", note: "Different grip" },
                { name: "Preacher Hammer Curls", sets: "3", reps: "10-12", note: "Brachialis focus" },
                { name: "Bayesian Bicep Curls", sets: "2", reps: "15", note: "Light pump finish" }
            ]},
            6: { title: "Day 6: Legs B", focus: "Hinge/Posterior Chain + Upper Abs", exercises: [
                { name: "Deadlifts", sets: "3", reps: "5-8", note: "Heavy - strict form" },
                { name: "Lying Hamstring Curls", sets: "3", reps: "10-12", note: "" },
                { name: "Quad Leg Extensions", sets: "3", reps: "12-15", note: "Maintain quad volume" },
                { name: "Seated Calf Raises", sets: "4", reps: "15-20", note: "" },
                { name: "Cable Crunches (Core)", sets: "3", reps: "15", note: "Upper abs" },
                { name: "Elliptical Machine", sets: "1", reps: "20-30 mins", note: "Moderate cardio" }
            ]},
            7: { title: "Day 7: Rest & Recovery", focus: "Active Recovery", exercises: [
                { name: "Inclined Treadmill Walk", sets: "1", reps: "45 mins", note: "Low intensity" },
                { name: "Foam Rolling", sets: "1", reps: "15-20 mins", note: "Full body" },
                { name: "Stretching", sets: "1", reps: "15-20 mins", note: "Focus on tight areas" }
            ]}
        };
        const nepaliMonths = ["‡§¨‡•à‡§∂‡§æ‡§ñ", "‡§ú‡•á‡§†", "‡§Ö‡§∏‡§æ‡§∞", "‡§∂‡•ç‡§∞‡§æ‡§µ‡§£", "‡§≠‡§¶‡•å", "‡§Ö‡§∏‡•ã‡§ú", "‡§ï‡§æ‡§∞‡•ç‡§§‡§ø‡§ï", "‡§Æ‡§Ç‡§∏‡§ø‡§∞", "‡§™‡•Å‡§∑", "‡§Æ‡§æ‡§ò", "‡§´‡§æ‡§≤‡•ç‡§ó‡•Å‡§®", "‡§ö‡•à‡§§‡•ç‡§∞"];
        const nepaliMonthsEng = ["Baisakh", "Jestha", "Ashar", "Shrawan", "Bhadra", "Ashwin", "Kartik", "Mangsir", "Poush", "Magh", "Falgun", "Chaitra"];
        const nepaliDays = ["‡§Ü‡§á‡§§‡§¨‡§æ‡§∞", "‡§∏‡•ã‡§Æ‡§¨‡§æ‡§∞", "‡§Æ‡§Ç‡§ó‡§≤‡§¨‡§æ‡§∞", "‡§¨‡•Å‡§ß‡§¨‡§æ‡§∞", "‡§¨‡§ø‡§π‡•Ä‡§¨‡§æ‡§∞", "‡§∂‡•Å‡§ï‡•ç‡§∞‡§¨‡§æ‡§∞", "‡§∂‡§®‡§ø‡§¨‡§æ‡§∞"];
        const nepaliNums = ["‡•¶", "‡•ß", "‡•®", "‡•©", "‡•™", "‡•´", "‡•¨", "‡•≠", "‡•Æ", "‡•Ø"];
        const bsMonthDays = [[2000,30,32,31,32,31,30,30,30,29,30,29,31],[2001,31,31,32,31,31,31,30,29,30,29,30,30],[2002,31,31,32,32,31,30,30,29,30,29,30,30],[2003,31,32,31,32,31,30,30,30,29,29,30,31],[2004,30,32,31,32,31,30,30,30,29,30,29,31],[2005,31,31,32,31,31,31,30,29,30,29,30,30],[2006,31,31,32,32,31,30,30,29,30,29,30,30],[2007,31,32,31,32,31,30,30,30,29,29,30,31],[2008,31,31,31,32,31,31,29,30,30,29,29,31],[2009,31,31,32,31,31,31,30,29,30,29,30,30],[2010,31,31,32,32,31,30,30,29,30,29,30,30],[2011,31,32,31,32,31,30,30,30,29,29,30,31],[2012,31,31,31,32,31,31,29,30,30,29,30,30],[2013,31,31,32,31,31,31,30,29,30,29,30,30],[2014,31,31,32,32,31,30,30,29,30,29,30,30],[2015,31,32,31,32,31,30,30,30,29,29,30,31],[2016,31,31,31,32,31,31,29,30,30,29,30,30],[2017,31,31,32,31,31,31,30,29,30,29,30,30],[2018,31,32,31,32,31,30,30,29,30,29,30,30],[2019,31,32,31,32,31,30,30,30,29,30,29,31],[2020,31,31,31,32,31,31,30,29,30,29,30,30],[2021,31,31,32,31,31,31,30,29,30,29,30,30],[2022,31,32,31,32,31,30,30,30,29,29,30,30],[2023,31,32,31,32,31,30,30,30,29,30,29,31],[2024,31,31,31,32,31,31,30,29,30,29,30,30],[2025,31,31,32,31,31,31,30,29,30,29,30,30],[2026,31,32,31,32,31,30,30,30,29,29,30,31],[2027,30,32,31,32,31,30,30,30,29,30,29,31],[2028,31,31,32,31,31,31,30,29,30,29,30,30],[2029,31,31,32,31,32,30,30,29,30,29,30,30],[2030,31,32,31,32,31,30,30,30,29,29,30,31],[2031,30,32,31,32,31,30,30,30,29,30,29,31],[2032,31,31,32,31,31,31,30,29,30,29,30,30],[2033,31,31,32,32,31,30,30,29,30,29,30,30],[2034,31,32,31,32,31,30,30,30,29,29,30,31],[2035,30,32,31,32,31,31,29,30,30,29,29,31],[2036,31,31,32,31,31,31,30,29,30,29,30,30],[2037,31,31,32,32,31,30,30,29,30,29,30,30],[2038,31,32,31,32,31,30,30,30,29,29,30,31],[2039,31,31,31,32,31,31,29,30,30,29,30,30],[2040,31,31,32,31,31,31,30,29,30,29,30,30],[2041,31,31,32,32,31,30,30,29,30,29,30,30],[2042,31,32,31,32,31,30,30,30,29,29,30,31],[2043,31,31,31,32,31,31,29,30,30,29,30,30],[2044,31,31,32,31,31,31,30,29,30,29,30,30],[2045,31,32,31,32,31,30,30,29,30,29,30,30],[2046,31,32,31,32,31,30,30,30,29,29,30,31],[2047,31,31,31,32,31,31,30,29,30,29,30,30],[2048,31,31,32,31,31,31,30,29,30,29,30,30],[2049,31,32,31,32,31,30,30,30,29,29,30,30],[2050,31,32,31,32,31,30,30,30,29,30,29,31],[2051,31,31,31,32,31,31,30,29,30,29,30,30],[2052,31,31,32,31,31,31,30,29,30,29,30,30],[2053,31,32,31,32,31,30,30,30,29,29,30,30],[2054,31,32,31,32,31,30,30,30,29,30,29,31],[2055,31,31,32,31,31,31,30,29,30,29,30,30],[2056,31,31,32,31,32,30,30,29,30,29,30,30],[2057,31,32,31,32,31,30,30,30,29,29,30,31],[2058,30,32,31,32,31,30,30,30,29,30,29,31],[2059,31,31,32,31,31,31,30,29,30,29,30,30],[2060,31,31,32,32,31,30,30,29,30,29,30,30],[2061,31,32,31,32,31,30,30,30,29,29,30,31],[2062,30,32,31,32,31,31,29,30,29,30,29,31],[2063,31,31,32,31,31,31,30,29,30,29,30,30],[2064,31,31,32,32,31,30,30,29,30,29,30,30],[2065,31,32,31,32,31,30,30,30,29,29,30,31],[2066,31,31,31,32,31,31,29,30,30,29,29,31],[2067,31,31,32,31,31,31,30,29,30,29,30,30],[2068,31,31,32,32,31,30,30,29,30,29,30,30],[2069,31,32,31,32,31,30,30,30,29,29,30,31],[2070,31,31,31,32,31,31,29,30,30,29,30,30],[2071,31,31,32,31,31,31,30,29,30,29,30,30],[2072,31,32,31,32,31,30,30,29,30,29,30,30],[2073,31,32,31,32,31,30,30,30,29,29,30,31],[2074,31,31,31,32,31,31,30,29,30,29,30,30],[2075,31,31,32,31,31,31,30,29,30,29,30,30],[2076,31,32,31,32,31,30,30,30,29,29,30,30],[2077,31,32,31,32,31,30,30,30,29,30,29,31],[2078,31,31,31,32,31,31,30,29,30,29,30,30],[2079,31,31,32,31,31,31,30,29,30,29,30,30],[2080,31,32,31,32,31,30,30,30,29,29,30,30],[2081,31,32,31,32,31,30,30,30,29,30,29,31],[2082,31,31,32,31,31,31,30,29,30,29,30,30],[2083,31,31,32,31,32,30,30,29,30,29,30,30],[2084,31,32,31,32,31,30,30,30,29,29,30,31],[2085,30,32,31,32,31,30,30,30,29,30,29,31],[2086,31,31,32,31,31,31,30,29,30,29,30,30],[2087,31,31,32,32,31,30,30,29,30,29,30,30],[2088,31,32,31,32,31,30,30,30,29,29,30,31],[2089,30,32,31,32,31,31,29,30,30,29,29,31],[2090,31,31,32,31,31,31,30,29,30,29,30,30],[2091,31,31,32,32,31,30,30,29,30,29,30,30],[2092,31,32,31,32,31,30,30,30,29,29,30,31],[2093,31,31,31,32,31,31,29,30,30,29,30,30],[2094,31,31,32,31,31,31,30,29,30,29,30,30],[2095,31,32,31,32,31,30,30,29,30,29,30,30],[2096,31,32,31,32,31,30,30,30,29,29,30,31],[2097,31,31,31,32,31,31,30,29,30,29,30,30],[2098,31,31,32,31,31,31,30,29,30,29,30,30],[2099,31,32,31,32,31,30,30,30,29,29,30,30],[2100,31,32,31,32,31,30,30,30,29,30,29,31]];
        function toNepaliNum(num) { return String(num).split('').map(d => nepaliNums[parseInt(d)]).join(''); }
        function adToBs(year, month, day) {
            const startAdDate = new Date(1943, 3, 14);
            const inputDate = new Date(year, month - 1, day);
            let totalDays = Math.floor((inputDate - startAdDate) / (1000 * 60 * 60 * 24));
            let bsYear = 2000, bsMonth = 1, bsDay = 1;
            while (totalDays > 0) {
                const yearData = bsMonthDays.find(y => y[0] === bsYear);
                if (!yearData) break;
                const daysInMonth = yearData[bsMonth];
                if (totalDays >= daysInMonth) { totalDays -= daysInMonth; bsMonth++; if (bsMonth > 12) { bsMonth = 1; bsYear++; } }
                else { bsDay = totalDays + 1; totalDays = 0; }
            }
            return { year: bsYear, month: bsMonth, day: bsDay };
        }
        let currentDay = 1;
        let currentCalendarDate = new Date();
        let completedExercises = JSON.parse(localStorage.getItem('completedExercises') || '{}');
        let completedDays = JSON.parse(localStorage.getItem('completedDays') || '{}');
        function init() { updateDateDisplay(); selectDay(1); renderCalendar(); updateStats(); }
        function updateDateDisplay() {
            const now = new Date();
            const dayName = now.toLocaleDateString('en-US', { weekday: 'long' });
            const englishDate = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            const bs = adToBs(now.getFullYear(), now.getMonth() + 1, now.getDate());
            const nepaliDate = toNepaliNum(bs.year) + ' ' + nepaliMonths[bs.month - 1] + ' ' + toNepaliNum(bs.day) + ' ' + nepaliDays[now.getDay()];
            document.getElementById('englishDate').textContent = englishDate;
            document.getElementById('dayName').textContent = dayName;
            document.getElementById('nepaliDate').textContent = nepaliDate;
        }
        function showView(view) {
            document.getElementById('workout-view').classList.add('hidden');
            document.getElementById('calendar-view').classList.add('hidden');
            document.getElementById('stats-view').classList.add('hidden');
            document.getElementById(view + '-view').classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(item => { item.classList.remove('active'); item.classList.add('text-gray-400'); });
            document.getElementById('nav-' + view).classList.add('active');
            document.getElementById('nav-' + view).classList.remove('text-gray-400');
            if (view === 'stats') updateStats();
            if (view === 'calendar') renderCalendar();
        }
        function selectDay(day) {
            currentDay = day;
            document.querySelectorAll('.day-tab').forEach(tab => { tab.classList.remove('active'); if (parseInt(tab.dataset.day) === day) tab.classList.add('active'); });
            const data = workoutData[day];
            document.getElementById('currentDayTitle').textContent = data.title;
            document.getElementById('currentDayFocus').textContent = data.focus;
            renderExercises();
            updateProgress();
        }
        function getDateKey(date) { date = date || new Date(); return date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate(); }
        function renderExercises() {
            const list = document.getElementById('exerciseList');
            const data = workoutData[currentDay];
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            if (!completedExercises[dayKey]) completedExercises[dayKey] = {};
            list.innerHTML = data.exercises.map((ex, index) => {
                const isCompleted = completedExercises[dayKey][index] || false;
                return '<div class="exercise-card ' + (isCompleted ? 'completed' : '') + ' rounded-xl p-4 animate-in" style="animation-delay: ' + (index * 50) + 'ms"><div class="flex items-start gap-3"><input type="checkbox" class="custom-checkbox mt-1 flex-shrink-0" ' + (isCompleted ? 'checked' : '') + ' onchange="toggleExercise(' + index + ', this.checked)"><div class="flex-1"><h4 class="font-semibold ' + (isCompleted ? 'line-through opacity-60' : '') + '">' + ex.name + '</h4><div class="flex items-center gap-3 mt-1"><span class="text-sm text-indigo-400">' + ex.sets + ' sets √ó ' + ex.reps + '</span>' + (ex.note ? '<span class="text-xs text-gray-500">‚Ä¢ ' + ex.note + '</span>' : '') + '</div></div></div></div>';
            }).join('');
        }
        function toggleExercise(index, completed) {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            if (!completedExercises[dayKey]) completedExercises[dayKey] = {};
            completedExercises[dayKey][index] = completed;
            localStorage.setItem('completedExercises', JSON.stringify(completedExercises));
            renderExercises();
            updateProgress();
            checkDayCompletion();
        }
        function updateProgress() {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            const exercises = workoutData[currentDay].exercises;
            const completed = Object.values(completedExercises[dayKey] || {}).filter(Boolean).length;
            const percentage = Math.round((completed / exercises.length) * 100);
            const circumference = 2 * Math.PI * 28;
            const offset = circumference - (percentage / 100) * circumference;
            document.getElementById('progressCircle').style.strokeDashoffset = offset;
            document.getElementById('progressText').textContent = percentage + '%';
        }
        function checkDayCompletion() {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            const exercises = workoutData[currentDay].exercises;
            const completed = Object.values(completedExercises[dayKey] || {}).filter(Boolean).length;
            if (completed === exercises.length) { completedDays[dateKey] = currentDay; localStorage.setItem('completedDays', JSON.stringify(completedDays)); }
        }
        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            const bs = adToBs(year, month + 1, 15);
            document.getElementById('calendarMonth').textContent = new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            document.getElementById('calendarNepaliMonth').textContent = nepaliMonthsEng[bs.month - 1] + ' ' + bs.year + ' BS';
            let html = '';
            for (let i = 0; i < firstDay; i++) html += '<div class="h-10"></div>';
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateKey = year + '-' + (month + 1) + '-' + day;
                const isToday = date.toDateString() === today.toDateString();
                const isCompleted = completedDays[dateKey];
                const cycleDay = (Math.floor((date - new Date(2024, 0, 1)) / (1000 * 60 * 60 * 24)) % 7) + 1;
                let classes = 'calendar-day h-10 flex items-center justify-center rounded-lg text-sm font-medium cursor-pointer hover:bg-slate-700';
                if (isToday) classes += ' today text-white';
                else if (isCompleted) classes += ' completed-day';
                else classes += ' bg-slate-800';
                if (!isToday && cycleDay !== 7) classes += ' has-workout';
                html += '<div class="' + classes + '" onclick="showDayInfo(\'' + dateKey + '\', ' + cycleDay + ')">' + day + '</div>';
            }
            grid.innerHTML = html;
        }
        function changeMonth(delta) { currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta); renderCalendar(); }
        function showDayInfo(dateKey, cycleDay) { console.log('Date: ' + dateKey + ', Cycle Day: ' + cycleDay); }
        function updateStats() {
            const totalWorkouts = Object.keys(completedDays).length;
            const totalExercises = Object.values(completedExercises).reduce((sum, day) => sum + Object.values(day).filter(Boolean).length, 0);
            let streak = 0;
            const today = new Date();
            for (let i = 0; i < 365; i++) {
                const checkDate = new Date(today);
                checkDate.setDate(checkDate.getDate() - i);
                const dateKey = getDateKey(checkDate);
                if (completedDays[dateKey]) streak++;
                else if (i > 0) break;
            }
            const weekStart = new Date(today);
            weekStart.setDate(weekStart.getDate() - weekStart.getDay());
            let weeklyCompleted = 0;
            for (let i = 0; i < 7; i++) {
                const checkDate = new Date(weekStart);
                checkDate.setDate(checkDate.getDate() + i);
                const dateKey = getDateKey(checkDate);
                if (completedDays[dateKey]) weeklyCompleted++;
                const dayEl = document.getElementById('weekDay' + i);
                if (dayEl) {
                    const box = dayEl.querySelector('div');
                    if (completedDays[dateKey]) box.className = 'w-8 h-8 rounded-lg bg-gradient-to-r from-green-500 to-emerald-500 mb-1';
                    else if (checkDate <= today) box.className = 'w-8 h-8 rounded-lg bg-slate-700 mb-1';
                    else box.className = 'w-8 h-8 rounded-lg bg-slate-800 mb-1';
                }
            }
            document.getElementById('totalWorkouts').textContent = totalWorkouts;
            document.getElementById('currentStreak').textContent = streak;
            document.getElementById('totalExercises').textContent = totalExercises;
            document.getElementById('weeklyProgress').textContent = Math.round((weeklyCompleted / 6) * 100) + '%';
        }
        function resetAllData() {
            if (confirm('Are you sure you want to reset all workout data? This cannot be undone.')) {
                localStorage.removeItem('completedExercises');
                localStorage.removeItem('completedDays');
                completedExercises = {};
                completedDays = {};
                renderExercises();
                updateProgress();
                updateStats();
                renderCalendar();
            }
        }
        init();
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js').then(function(registration) {
                    console.log('ServiceWorker registered:', registration.scope);
                }).catch(function(error) {
                    console.log('ServiceWorker registration failed:', error);
                });
            });
        }
        window.addEventListener('beforeinstallprompt', function(e) {
            e.preventDefault();
            deferredPrompt = e;
            const dismissed = localStorage.getItem('installDismissed');
            const dismissedTime = dismissed ? parseInt(dismissed) : 0;
            const daysSinceDismissed = (Date.now() - dismissedTime) / (1000 * 60 * 60 * 24);
            if (daysSinceDismissed > 7) installBanner.classList.remove('hidden');
        });
        function installApp() {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then(function(choiceResult) {
                if (choiceResult.outcome === 'accepted') console.log('User accepted install');
                deferredPrompt = null;
                installBanner.classList.add('hidden');
            });
        }
        function dismissInstall() {
            installBanner.classList.add('hidden');
            localStorage.setItem('installDismissed', Date.now().toString());
        }
        window.addEventListener('appinstalled', function() {
            console.log('App installed successfully');
            installBanner.classList.add('hidden');
            deferredPrompt = null;
        });
    </script>
</body>
</html>
