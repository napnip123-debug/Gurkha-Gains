<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Kritik's Gurkha Gains</title>
    <meta name="description" content="Cyberpunk PPL Workout Tracker with Nepali Calendar">
    <meta name="theme-color" content="#0a0a0f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Gurkha Gains">
    <link rel="manifest" href="manifest.json">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@400;500;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-cyan: #00f0ff;
            --neon-magenta: #ff00ff;
            --neon-yellow: #ffd700;
            --neon-green: #39ff14;
            --neon-red: #ff073a;
            --neon-orange: #ff6b35;
            --dark-bg: #0a0a0f;
            --dark-card: #12121a;
            --dark-border: #1a1a2e;
        }
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body { 
            font-family: 'Rajdhani', sans-serif;
            background: var(--dark-bg);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                linear-gradient(90deg, rgba(0,240,255,0.03) 1px, transparent 1px),
                linear-gradient(rgba(0,240,255,0.03) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 0;
        }
        
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0,0,0,0.1) 0px,
                rgba(0,0,0,0.1) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 9999;
            opacity: 0.3;
        }
        
        .app-container { 
            max-width: 430px; 
            margin: 0 auto; 
            min-height: 100vh; 
            position: relative;
            z-index: 1;
        }
        
        .glow-cyan { 
            text-shadow: 0 0 10px var(--neon-cyan), 0 0 20px var(--neon-cyan), 0 0 40px var(--neon-cyan); 
            color: var(--neon-cyan);
        }
        .glow-magenta { 
            text-shadow: 0 0 10px var(--neon-magenta), 0 0 20px var(--neon-magenta); 
            color: var(--neon-magenta);
        }
        .glow-green { 
            text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green); 
            color: var(--neon-green);
        }
        
        /* Header */
        .cyber-header {
            background: linear-gradient(180deg, rgba(0,240,255,0.1) 0%, transparent 100%);
            border-bottom: 2px solid var(--neon-cyan);
            padding: 12px 16px;
            position: sticky;
            top: 0;
            z-index: 50;
            backdrop-filter: blur(20px);
        }
        
        .cyber-header::before {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-cyan), var(--neon-magenta), var(--neon-cyan), transparent);
            animation: headerGlow 3s ease-in-out infinite;
        }
        
        @keyframes headerGlow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .logo-text {
            font-family: 'Orbitron', monospace;
            font-weight: 800;
            font-size: 1.1rem;
            letter-spacing: 2px;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-magenta));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-transform: uppercase;
        }
        
        .nepali-date {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.7rem;
            color: var(--neon-yellow);
            opacity: 0.9;
        }
        
        /* Navigation */
        .cyber-nav {
            display: flex;
            justify-content: center;
            gap: 6px;
            padding: 10px 12px;
            background: rgba(10,10,15,0.95);
            border-bottom: 1px solid var(--dark-border);
            position: sticky;
            top: 68px;
            z-index: 40;
            backdrop-filter: blur(10px);
        }
        
        .nav-btn {
            font-family: 'Orbitron', monospace;
            font-size: 0.6rem;
            font-weight: 600;
            padding: 8px 12px;
            background: transparent;
            border: 1px solid var(--dark-border);
            color: #666;
            cursor: pointer;
            transition: all 0.3s ease;
            clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
            position: relative;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .nav-btn.active {
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            box-shadow: 0 0 15px rgba(0,240,255,0.3), inset 0 0 15px rgba(0,240,255,0.1);
        }
        
        /* Day Selector */
        .day-selector {
            display: flex;
            gap: 6px;
            overflow-x: auto;
            padding: 12px;
            scrollbar-width: none;
        }
        
        .day-selector::-webkit-scrollbar { display: none; }
        
        .day-chip {
            flex-shrink: 0;
            padding: 10px 12px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            clip-path: polygon(6px 0, 100% 0, 100% calc(100% - 6px), calc(100% - 6px) 100%, 0 100%, 0 6px);
            text-align: center;
        }
        
        .day-chip.active {
            border-color: var(--neon-cyan);
            background: linear-gradient(180deg, rgba(0,240,255,0.15) 0%, transparent 100%);
            box-shadow: 0 0 20px rgba(0,240,255,0.2);
        }
        
        .day-chip.today {
            border-color: var(--neon-green);
            box-shadow: 0 0 15px rgba(57,255,20,0.3);
        }
        
        .day-chip.today::after {
            content: '‡§Ü‡§ú';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.45rem;
            color: var(--dark-bg);
            background: var(--neon-green);
            padding: 1px 5px;
            border-radius: 2px;
            font-weight: 700;
        }
        
        .day-number {
            font-family: 'Orbitron', monospace;
            font-size: 1rem;
            font-weight: 700;
            color: var(--neon-cyan);
        }
        
        .day-name {
            font-size: 0.55rem;
            color: #888;
            margin-top: 2px;
        }
        
        .day-name-nepali {
            font-size: 0.5rem;
            color: var(--neon-yellow);
            margin-top: 1px;
        }
        
        .day-type {
            font-size: 0.5rem;
            color: var(--neon-magenta);
            margin-top: 3px;
            font-weight: 600;
        }
        
        /* Creatine Tracker */
        .creatine-tracker {
            margin: 0 12px 12px;
            padding: 12px 16px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
        }
        
        .creatine-label {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .creatine-icon {
            font-size: 1.3rem;
        }
        
        .creatine-text {
            font-family: 'Orbitron', monospace;
            font-size: 0.7rem;
            color: var(--neon-cyan);
        }
        
        .creatine-btn {
            padding: 8px 16px;
            border: 1px solid var(--neon-magenta);
            background: transparent;
            color: var(--neon-magenta);
            font-family: 'Orbitron', monospace;
            font-size: 0.6rem;
            cursor: pointer;
            transition: all 0.3s;
            clip-path: polygon(5px 0, 100% 0, 100% calc(100% - 5px), calc(100% - 5px) 100%, 0 100%, 0 5px);
        }
        
        .creatine-btn.taken {
            background: linear-gradient(135deg, var(--neon-green), #00ff88);
            border-color: var(--neon-green);
            color: var(--dark-bg);
            box-shadow: 0 0 15px var(--neon-green);
        }
        
        /* Weight Unit Selector */
        .weight-unit-selector {
            margin: 0 12px 12px;
            padding: 10px 16px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
        }
        
        .unit-label {
            font-family: 'Orbitron', monospace;
            font-size: 0.65rem;
            color: #888;
        }
        
        .unit-toggle {
            display: flex;
            gap: 4px;
        }
        
        .unit-btn {
            padding: 6px 14px;
            border: 1px solid var(--dark-border);
            background: transparent;
            color: #666;
            font-family: 'Orbitron', monospace;
            font-size: 0.65rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .unit-btn.active {
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
            background: rgba(0,240,255,0.1);
        }
        
        /* Workout Header Card */
        .workout-header {
            margin: 0 12px 12px;
            padding: 16px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            position: relative;
            overflow: hidden;
            clip-path: polygon(0 0, calc(100% - 16px) 0, 100% 16px, 100% 100%, 16px 100%, 0 calc(100% - 16px));
        }
        
        .workout-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-magenta), var(--neon-yellow));
        }
        
        .workout-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.1rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 4px;
        }
        
        .workout-focus {
            font-size: 0.75rem;
            color: var(--neon-magenta);
            margin-bottom: 12px;
        }
        
        /* Progress Ring */
        .progress-container {
            position: relative;
            width: 80px;
            height: 80px;
        }
        
        .progress-ring {
            transform: rotate(-90deg);
            filter: drop-shadow(0 0 8px var(--neon-cyan));
        }
        
        .progress-ring-bg { stroke: var(--dark-border); }
        
        .progress-ring-fill {
            stroke: url(#cyberGradient);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }
        
        .progress-text {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .progress-percent {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--neon-cyan);
            text-shadow: 0 0 15px var(--neon-cyan);
        }
        
        .progress-label {
            font-size: 0.5rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Exercise Cards */
        .exercise-list {
            padding: 0 12px 100px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .exercise-card {
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            padding: 14px;
            position: relative;
            transition: all 0.3s ease;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }
        
        .exercise-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(180deg, var(--neon-cyan), var(--neon-magenta));
            opacity: 0.5;
            transition: opacity 0.3s;
        }
        
        .exercise-card.completed {
            background: linear-gradient(135deg, rgba(57,255,20,0.1) 0%, transparent 50%);
            border-color: var(--neon-green);
        }
        
        .exercise-card.completed::before {
            background: var(--neon-green);
            opacity: 1;
            box-shadow: 0 0 10px var(--neon-green);
        }
        
        .exercise-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .exercise-info { flex: 1; }
        
        .muscle-tag {
            font-family: 'Orbitron', monospace;
            font-size: 0.5rem;
            color: var(--neon-magenta);
            background: rgba(255,0,255,0.1);
            padding: 2px 6px;
            border: 1px solid rgba(255,0,255,0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            display: inline-block;
            margin-bottom: 4px;
        }
        
        .exercise-name {
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            color: #fff;
        }
        
        .exercise-note {
            font-size: 0.65rem;
            color: #666;
            font-style: italic;
            margin-top: 2px;
        }
        
        /* Weight Input */
        .weight-input-container {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--dark-border);
        }
        
        .weight-label {
            font-size: 0.6rem;
            color: #666;
            font-family: 'Orbitron', monospace;
        }
        
        .weight-controls {
            display: flex;
            align-items: center;
            gap: 2px;
            margin-left: auto;
        }
        
        .weight-btn {
            width: 28px;
            height: 28px;
            border: 1px solid var(--neon-cyan);
            background: transparent;
            color: var(--neon-cyan);
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .weight-btn:hover {
            background: rgba(0,240,255,0.2);
        }
        
        .weight-display {
            width: 60px;
            text-align: center;
            font-family: 'Orbitron', monospace;
            font-size: 0.8rem;
            color: var(--neon-yellow);
            background: transparent;
            border: 1px solid var(--dark-border);
            padding: 4px;
        }
        
        /* Set Checkboxes */
        .sets-container {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 10px;
        }
        
        .set-item {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 8px;
            background: rgba(0,0,0,0.3);
            border: 1px solid var(--dark-border);
            border-radius: 4px;
        }
        
        .set-checkbox {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid var(--neon-cyan);
            background: transparent;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .set-checkbox:checked {
            background: linear-gradient(135deg, var(--neon-green), #00ff88);
            border-color: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
        }
        
        .set-checkbox:checked::after {
            content: '‚úì';
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--dark-bg);
            font-weight: bold;
            font-size: 12px;
        }
        
        .set-label {
            font-family: 'Orbitron', monospace;
            font-size: 0.55rem;
            color: #888;
        }
        
        .set-reps {
            font-size: 0.5rem;
            color: var(--neon-cyan);
        }
        
        /* Calendar View */
        .calendar-container {
            margin: 12px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            padding: 16px;
            clip-path: polygon(12px 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%, 0 12px);
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .calendar-nav-btn {
            width: 36px;
            height: 36px;
            background: transparent;
            border: 1px solid var(--neon-cyan);
            color: var(--neon-cyan);
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .calendar-title { text-align: center; }
        
        .calendar-month {
            font-family: 'Orbitron', monospace;
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--neon-cyan);
        }
        
        .calendar-nepali {
            font-size: 0.7rem;
            color: var(--neon-magenta);
            margin-top: 2px;
        }
        
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-bottom: 6px;
        }
        
        .calendar-weekday {
            font-family: 'Rajdhani', sans-serif;
            font-size: 0.55rem;
            color: var(--neon-yellow);
            text-align: center;
            padding: 6px 0;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.75rem;
            background: rgba(255,255,255,0.02);
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .calendar-day:hover {
            border-color: var(--neon-cyan);
            background: rgba(0,240,255,0.1);
        }
        
        .calendar-day.today {
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-magenta));
            color: var(--dark-bg);
            font-weight: 700;
            box-shadow: 0 0 15px rgba(0,240,255,0.5);
        }
        
        .calendar-day.has-workout {
            border-color: rgba(0,240,255,0.3);
        }
        
        .calendar-day.completed-day {
            background: rgba(57,255,20,0.2);
            border-color: var(--neon-green);
        }
        
        .calendar-day.holiday {
            background: rgba(255,0,255,0.15);
            border-color: var(--neon-magenta);
        }
        
        .holiday-dot {
            width: 4px;
            height: 4px;
            background: var(--neon-yellow);
            border-radius: 50%;
            position: absolute;
            bottom: 3px;
        }
        
        /* Holiday Info */
        .holiday-info {
            margin: 12px;
            padding: 12px;
            background: var(--dark-card);
            border: 1px solid var(--neon-magenta);
            display: none;
        }
        
        .holiday-info.show { display: block; }
        
        .holiday-info h4 {
            font-family: 'Orbitron', monospace;
            font-size: 0.7rem;
            color: var(--neon-magenta);
            margin-bottom: 8px;
        }
        
        .holiday-list {
            font-size: 0.75rem;
            color: #ccc;
        }
        
        .holiday-item {
            padding: 6px 0;
            border-bottom: 1px solid var(--dark-border);
            display: flex;
            justify-content: space-between;
        }
        
        .holiday-item:last-child { border-bottom: none; }
        
        .holiday-name { color: var(--neon-yellow); }
        .holiday-type { color: #666; font-size: 0.6rem; }
        
        /* Stats View */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            padding: 12px;
        }
        
        .stat-card {
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            padding: 16px;
            text-align: center;
            position: relative;
            overflow: hidden;
            clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
        }
        
        .stat-card.cyan::before { background: var(--neon-cyan); }
        .stat-card.magenta::before { background: var(--neon-magenta); }
        .stat-card.green::before { background: var(--neon-green); }
        .stat-card.yellow::before { background: var(--neon-yellow); }
        
        .stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .stat-card.cyan .stat-value { color: var(--neon-cyan); text-shadow: 0 0 15px var(--neon-cyan); }
        .stat-card.magenta .stat-value { color: var(--neon-magenta); text-shadow: 0 0 15px var(--neon-magenta); }
        .stat-card.green .stat-value { color: var(--neon-green); text-shadow: 0 0 15px var(--neon-green); }
        .stat-card.yellow .stat-value { color: var(--neon-yellow); text-shadow: 0 0 15px var(--neon-yellow); }
        
        .stat-label {
            font-size: 0.65rem;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Weekly Overview */
        .weekly-overview {
            margin: 0 12px 12px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            padding: 16px;
            clip-path: polygon(8px 0, 100% 0, 100% calc(100% - 8px), calc(100% - 8px) 100%, 0 100%, 0 8px);
        }
        
        .weekly-title {
            font-family: 'Orbitron', monospace;
            font-size: 0.75rem;
            color: var(--neon-cyan);
            margin-bottom: 12px;
            letter-spacing: 2px;
        }
        
        .weekly-days {
            display: flex;
            justify-content: space-between;
        }
        
        .weekly-day {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        .weekly-day-box {
            width: 32px;
            height: 32px;
            background: var(--dark-border);
            border: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
            transition: all 0.3s;
        }
        
        .weekly-day-box.completed {
            background: linear-gradient(135deg, var(--neon-green), #00ff88);
            border-color: var(--neon-green);
            box-shadow: 0 0 10px var(--neon-green);
            color: var(--dark-bg);
        }
        
        .weekly-day-label {
            font-size: 0.5rem;
            color: #666;
        }
        
        .weekly-day-nepali {
            font-size: 0.45rem;
            color: var(--neon-yellow);
        }
        
        /* Export Button */
        .export-btn {
            margin: 0 12px 12px;
            width: calc(100% - 24px);
            padding: 14px;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-magenta));
            border: none;
            color: var(--dark-bg);
            font-family: 'Orbitron', monospace;
            font-size: 0.75rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }
        
        .export-btn:hover {
            box-shadow: 0 0 25px rgba(0,240,255,0.5);
            transform: translateY(-2px);
        }
        
        /* Reset Button */
        .reset-btn {
            margin: 0 12px 100px;
            width: calc(100% - 24px);
            padding: 14px;
            background: transparent;
            border: 1px solid var(--neon-red);
            color: var(--neon-red);
            font-family: 'Orbitron', monospace;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 2px;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
        }
        
        .reset-btn:hover {
            background: rgba(255,7,58,0.1);
            box-shadow: 0 0 15px rgba(255,7,58,0.3);
        }
        
        /* XP Bar */
        .xp-bar-container {
            margin: 0 12px 12px;
            background: var(--dark-card);
            border: 1px solid var(--dark-border);
            padding: 10px 14px;
            clip-path: polygon(6px 0, 100% 0, 100% calc(100% - 6px), calc(100% - 6px) 100%, 0 100%, 0 6px);
        }
        
        .xp-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
        }
        
        .xp-level {
            font-family: 'Orbitron', monospace;
            font-size: 0.65rem;
            color: var(--neon-yellow);
        }
        
        .xp-amount {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.6rem;
            color: #666;
        }
        
        .xp-bar {
            height: 5px;
            background: var(--dark-border);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-yellow), var(--neon-orange));
            box-shadow: 0 0 8px var(--neon-yellow);
            transition: width 0.5s ease;
        }
        
        /* Install Banner */
        .install-banner {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            background: linear-gradient(135deg, var(--neon-green), #00ff88);
            padding: 10px 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .install-banner.hidden { display: none; }
        
        .install-text { color: var(--dark-bg); }
        
        .install-title {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            font-size: 0.75rem;
        }
        
        .install-subtitle {
            font-size: 0.6rem;
            opacity: 0.8;
        }
        
        .install-btn {
            background: var(--dark-bg);
            color: var(--neon-green);
            border: none;
            padding: 6px 12px;
            font-family: 'Orbitron', monospace;
            font-size: 0.6rem;
            cursor: pointer;
            font-weight: 700;
        }
        
        .install-dismiss {
            background: none;
            border: none;
            color: var(--dark-bg);
            font-size: 0.7rem;
            cursor: pointer;
            padding: 6px;
            opacity: 0.8;
        }
        
        .hidden { display: none !important; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 8px; }
        .gap-3 { gap: 12px; }
        .flex-1 { flex: 1; }
    </style>
</head>
<body>
    <!-- Install Banner -->
    <div id="installBanner" class="install-banner hidden">
        <div class="flex items-center gap-2">
            <span style="font-size: 1.3rem;">‚ö°</span>
            <div class="install-text">
                <div class="install-title">INSTALL GURKHA GAINS</div>
                <div class="install-subtitle">Add to home screen</div>
            </div>
        </div>
        <div class="flex items-center gap-2">
            <button onclick="dismissInstall()" class="install-dismiss">‚úï</button>
            <button onclick="installApp()" class="install-btn">INSTALL</button>
        </div>
    </div>

    <div class="app-container">
        <!-- Header -->
        <header class="cyber-header">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="logo-text">‚ö° Kritik's Gurkha Gains</h1>
                    <p class="nepali-date" id="nepaliDate">‡§≤‡•ã‡§° ‡§π‡•Å‡§Å‡§¶‡•à‡§õ...</p>
                </div>
                <div style="text-align: right;">
                    <p style="font-family: 'Share Tech Mono', monospace; font-size: 0.7rem; color: var(--neon-cyan);" id="englishDate"></p>
                    <p style="font-size: 0.6rem; color: #666;" id="dayName"></p>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="cyber-nav">
            <button onclick="showView('workout')" class="nav-btn active" id="nav-workout">üí™ WORKOUT</button>
            <button onclick="showView('calendar')" class="nav-btn" id="nav-calendar">üìÖ ‡§™‡§æ‡§§‡•ç‡§∞‡•ã</button>
            <button onclick="showView('stats')" class="nav-btn" id="nav-stats">üìä STATS</button>
        </nav>

        <!-- Workout View -->
        <div id="workout-view">
            <!-- Day Selector -->
            <div class="day-selector" id="dayTabs"></div>

            <!-- Creatine Tracker -->
            <div class="creatine-tracker">
                <div class="creatine-label">
                    <span class="creatine-icon">üíä</span>
                    <div>
                        <div class="creatine-text">CREATINE ‡§Ü‡§ú?</div>
                        <div style="font-size: 0.55rem; color: #666;">Daily 5g dose</div>
                    </div>
                </div>
                <button id="creatineBtn" class="creatine-btn" onclick="toggleCreatine()">NOT TAKEN</button>
            </div>

            <!-- Weight Unit Selector -->
            <div class="weight-unit-selector">
                <span class="unit-label">‚öñÔ∏è WEIGHT UNIT</span>
                <div class="unit-toggle">
                    <button class="unit-btn active" id="unitLbs" onclick="setWeightUnit('lbs')">LBS</button>
                    <button class="unit-btn" id="unitKg" onclick="setWeightUnit('kg')">KG</button>
                </div>
            </div>

            <!-- XP Bar -->
            <div class="xp-bar-container">
                <div class="xp-header">
                    <span class="xp-level">‚ö° LEVEL <span id="userLevel">1</span> ‡§Ø‡•ã‡§¶‡•ç‡§ß‡§æ</span>
                    <span class="xp-amount"><span id="currentXP">0</span> / <span id="nextLevelXP">100</span> XP</span>
                </div>
                <div class="xp-bar">
                    <div class="xp-fill" id="xpFill" style="width: 0%;"></div>
                </div>
            </div>

            <!-- Workout Header -->
            <div class="workout-header">
                <div class="flex justify-between items-center">
                    <div>
                        <h2 class="workout-title" id="currentDayTitle">DAY 1: PUSH A</h2>
                        <p class="workout-focus" id="currentDayFocus">// HEAVY PRESS & TRICEPS</p>
                    </div>
                    <div class="progress-container">
                        <svg class="progress-ring" width="80" height="80">
                            <defs>
                                <linearGradient id="cyberGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" stop-color="#00f0ff"/>
                                    <stop offset="50%" stop-color="#ff00ff"/>
                                    <stop offset="100%" stop-color="#00f0ff"/>
                                </linearGradient>
                            </defs>
                            <circle class="progress-ring-bg" cx="40" cy="40" r="34" stroke-width="5" fill="none"/>
                            <circle class="progress-ring-fill" id="progressCircle" cx="40" cy="40" r="34" stroke-width="5" fill="none" stroke-dasharray="214" stroke-dashoffset="214"/>
                        </svg>
                        <div class="progress-text">
                            <span class="progress-percent" id="progressText">0%</span>
                            <span class="progress-label">DONE</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Exercise List -->
            <div class="exercise-list" id="exerciseList"></div>
        </div>

        <!-- Calendar View -->
        <div id="calendar-view" class="hidden">
            <div class="calendar-container">
                <div class="calendar-header">
                    <button onclick="changeMonth(-1)" class="calendar-nav-btn">‚óÄ</button>
                    <div class="calendar-title">
                        <div class="calendar-month" id="calendarMonth"></div>
                        <div class="calendar-nepali" id="calendarNepaliMonth"></div>
                    </div>
                    <button onclick="changeMonth(1)" class="calendar-nav-btn">‚ñ∂</button>
                </div>
                <div class="calendar-weekdays">
                    <div class="calendar-weekday">‡§Ü‡§á‡§§</div>
                    <div class="calendar-weekday">‡§∏‡•ã‡§Æ</div>
                    <div class="calendar-weekday">‡§Æ‡§Ç‡§ó‡§≤</div>
                    <div class="calendar-weekday">‡§¨‡•Å‡§ß</div>
                    <div class="calendar-weekday">‡§¨‡§ø‡§π‡•Ä</div>
                    <div class="calendar-weekday">‡§∂‡•Å‡§ï‡•ç‡§∞</div>
                    <div class="calendar-weekday">‡§∂‡§®‡§ø</div>
                </div>
                <div class="calendar-grid" id="calendarGrid"></div>
            </div>
            
            <div class="holiday-info" id="holidayInfo">
                <h4>üéâ ‡§¨‡§ø‡§¶‡§æ‡§π‡§∞‡•Ç / HOLIDAYS</h4>
                <div class="holiday-list" id="holidayList"></div>
            </div>
            
            <div style="padding: 12px; font-size: 0.6rem; color: #666; display: flex; gap: 12px; flex-wrap: wrap;">
                <span>üü¶ ‡§Ü‡§ú</span>
                <span>üü© Completed</span>
                <span>üü™ ‡§¨‡§ø‡§¶‡§æ/Holiday</span>
            </div>
        </div>

        <!-- Stats View -->
        <div id="stats-view" class="hidden">
            <div class="stats-grid">
                <div class="stat-card green">
                    <div class="stat-value" id="totalWorkouts">0</div>
                    <div class="stat-label">Workouts</div>
                </div>
                <div class="stat-card cyan">
                    <div class="stat-value" id="currentStreak">0</div>
                    <div class="stat-label">Streak üî•</div>
                </div>
                <div class="stat-card magenta">
                    <div class="stat-value" id="totalSets">0</div>
                    <div class="stat-label">Sets Done</div>
                </div>
                <div class="stat-card yellow">
                    <div class="stat-value" id="creatineDays">0</div>
                    <div class="stat-label">Creatine üíä</div>
                </div>
            </div>

            <div class="weekly-overview">
                <div class="weekly-title">// ‡§∏‡§æ‡§™‡•ç‡§§‡§æ‡§π‡§ø‡§ï MISSION STATUS</div>
                <div class="weekly-days" id="weeklyDays"></div>
            </div>

            <button onclick="exportStats()" class="export-btn">üì§ EXPORT STATISTICS</button>
            <button onclick="resetAllData()" class="reset-btn">‚ö† RESET ALL DATA</button>
        </div>
    </div>

    <script>
        // Updated Workout Data with Forearms
        const workoutData = {
            1: { 
                title: "DAY 1: PUSH A", 
                nepaliDay: "‡§Ü‡§á‡§§‡§¨‡§æ‡§∞",
                focus: "// HEAVY PRESS & TRICEPS", 
                exercises: [
                    { name: "Inclined Smith Machine Chest Press", sets: 3, reps: "8-10", note: "Heavy compound", muscle: "CHEST" },
                    { name: "Dips", sets: 3, reps: "10-12", note: "Lower chest/triceps", muscle: "CHEST" },
                    { name: "Chest Fly Machine", sets: 3, reps: "12-15", note: "Peak contraction", muscle: "CHEST" },
                    { name: "Cable Lateral Raises", sets: 4, reps: "12-15", note: "Constant tension", muscle: "DELTS" },
                    { name: "Cable Tricep Push Downs", sets: 3, reps: "10-12", note: "Rope or straight bar", muscle: "TRICEPS" },
                    { name: "EZ Bar Skull Crushers", sets: 3, reps: "8-10", note: "Long head mass builder", muscle: "TRICEPS" }
                ]
            },
            2: { 
                title: "DAY 2: PULL A", 
                nepaliDay: "‡§∏‡•ã‡§Æ‡§¨‡§æ‡§∞",
                focus: "// VERTICAL PULL & FOREARM WIDTH", 
                exercises: [
                    { name: "Pull Ups", sets: 3, reps: "AMRAP", note: "Add weight if needed", muscle: "BACK" },
                    { name: "Lat Pulldowns", sets: 3, reps: "10-12", note: "Wide grip", muscle: "LATS" },
                    { name: "Lat Prayers", sets: 3, reps: "12-15", note: "Straight arm pulldowns", muscle: "LATS" },
                    { name: "Seated Chest Supported Rows", sets: 3, reps: "10-12", note: "Upper back thickness", muscle: "BACK" },
                    { name: "Bayesian Bicep Curls", sets: 3, reps: "12-15", note: "Full stretch position", muscle: "BICEPS" },
                    { name: "Preacher Bicep Curls", sets: 3, reps: "10-12", note: "Short head isolation", muscle: "BICEPS" },
                    { name: "Reverse Cable Curls", sets: 3, reps: "12-15", note: "Extensors & Brachioradialis", muscle: "FOREARMS" }
                ]
            },
            3: { 
                title: "DAY 3: LEGS A", 
                nepaliDay: "‡§Æ‡§Ç‡§ó‡§≤‡§¨‡§æ‡§∞",
                focus: "// SQUAT FOCUS + LOWER ABS", 
                exercises: [
                    { name: "Squats", sets: 3, reps: "6-8", note: "Primary heavy compound", muscle: "QUADS" },
                    { name: "Hip Thrust Machine", sets: 3, reps: "10-12", note: "Glute focus", muscle: "GLUTES" },
                    { name: "Quad Leg Extensions", sets: 3, reps: "12-15", note: "Quad isolation", muscle: "QUADS" },
                    { name: "Seated Calf Raises", sets: 4, reps: "15-20", note: "Full ROM", muscle: "CALVES" },
                    { name: "Leg Raises", sets: 3, reps: "15", note: "Lower abs", muscle: "ABS" },
                    { name: "Inclined Treadmill Walk", sets: 1, reps: "20-30 min", note: "Steady state cardio", muscle: "CARDIO" }
                ]
            },
            4: { 
                title: "DAY 4: PUSH B", 
                nepaliDay: "‡§¨‡•Å‡§ß‡§¨‡§æ‡§∞",
                focus: "// VOLUME & SHOULDER DETAIL", 
                exercises: [
                    { name: "Hammer Chest Press", sets: 3, reps: "8-10", note: "Heavy flat press", muscle: "CHEST" },
                    { name: "Inclined Machine Press", sets: 3, reps: "10-12", note: "Upper pec shelf", muscle: "CHEST" },
                    { name: "Multiflight Lateral Raise Machine", sets: 4, reps: "12-15", note: "Drop sets work well", muscle: "DELTS" },
                    { name: "Inclined Y Raises", sets: 3, reps: "12-15", note: "Lower traps/rear delts", muscle: "DELTS" },
                    { name: "Cable Tricep Extension (Overhead)", sets: 3, reps: "12-15", note: "Long head stretch", muscle: "TRICEPS" }
                ]
            },
            5: { 
                title: "DAY 5: PULL B", 
                nepaliDay: "‡§¨‡§ø‡§π‡•Ä‡§¨‡§æ‡§∞",
                focus: "// ROW FOCUS & GRIP STRENGTH", 
                exercises: [
                    { name: "Seated Cable Rows", sets: 3, reps: "10-12", note: "Squeeze at contraction", muscle: "BACK" },
                    { name: "Inclined DB Chest Supported Rows", sets: 3, reps: "10-12", note: "No lower back strain", muscle: "BACK" },
                    { name: "Lat Pulldowns (Neutral Grip)", sets: 3, reps: "10-12", note: "Close grip variation", muscle: "LATS" },
                    { name: "Preacher Hammer Curls", sets: 3, reps: "10-12", note: "Brachialis focus", muscle: "BICEPS" },
                    { name: "Bayesian Bicep Curls", sets: 2, reps: "15", note: "Light pump finisher", muscle: "BICEPS" },
                    { name: "Behind-the-Back Barbell Wrist Curls", sets: 3, reps: "15-20", note: "Flexors - inner forearm", muscle: "FOREARMS" }
                ]
            },
            6: { 
                title: "DAY 6: LEGS B", 
                nepaliDay: "‡§∂‡•Å‡§ï‡•ç‡§∞‡§¨‡§æ‡§∞",
                focus: "// DEADLIFT FOCUS + UPPER ABS", 
                exercises: [
                    { name: "Deadlifts", sets: 3, reps: "5-8", note: "Heavy - strict form", muscle: "POSTERIOR" },
                    { name: "Lying Hamstring Curls", sets: 3, reps: "10-12", note: "Hamstring isolation", muscle: "HAMSTRINGS" },
                    { name: "Quad Leg Extensions", sets: 3, reps: "12-15", note: "Maintain quad volume", muscle: "QUADS" },
                    { name: "Seated Calf Raises", sets: 4, reps: "15-20", note: "Full ROM", muscle: "CALVES" },
                    { name: "Cable Crunches", sets: 3, reps: "15", note: "Upper abs", muscle: "ABS" },
                    { name: "Elliptical Machine", sets: 1, reps: "20-30 min", note: "Moderate cardio", muscle: "CARDIO" }
                ]
            },
            7: { 
                title: "DAY 7: REST", 
                nepaliDay: "‡§∂‡§®‡§ø‡§¨‡§æ‡§∞",
                focus: "// ACTIVE RECOVERY - ‡§Ü‡§∞‡§æ‡§Æ", 
                exercises: [
                    { name: "Light Walking", sets: 1, reps: "30-45 min", note: "Active recovery", muscle: "RECOVERY" },
                    { name: "Foam Rolling", sets: 1, reps: "15-20 min", note: "Full body", muscle: "MOBILITY" },
                    { name: "Stretching", sets: 1, reps: "15-20 min", note: "Focus on tight areas", muscle: "MOBILITY" }
                ]
            }
        };

        const shortDayNames = ["SUN", "MON", "TUE", "WED", "THU", "FRI", "SAT"];
        const nepaliDayNames = ["‡§Ü‡§á‡§§", "‡§∏‡•ã‡§Æ", "‡§Æ‡§Ç‡§ó‡§≤", "‡§¨‡•Å‡§ß", "‡§¨‡§ø‡§π‡•Ä", "‡§∂‡•Å‡§ï‡•ç‡§∞", "‡§∂‡§®‡§ø"];
        const nepaliDayNamesFull = ["‡§Ü‡§á‡§§‡§¨‡§æ‡§∞", "‡§∏‡•ã‡§Æ‡§¨‡§æ‡§∞", "‡§Æ‡§Ç‡§ó‡§≤‡§¨‡§æ‡§∞", "‡§¨‡•Å‡§ß‡§¨‡§æ‡§∞", "‡§¨‡§ø‡§π‡•Ä‡§¨‡§æ‡§∞", "‡§∂‡•Å‡§ï‡•ç‡§∞‡§¨‡§æ‡§∞", "‡§∂‡§®‡§ø‡§¨‡§æ‡§∞"];
        const workoutTypes = ["PUSH A", "PULL A", "LEGS A", "PUSH B", "PULL B", "LEGS B", "REST"];

        // Nepali Calendar Data
        const nepaliMonths = ["‡§¨‡•à‡§∂‡§æ‡§ñ", "‡§ú‡•á‡§†", "‡§Ö‡§∏‡§æ‡§∞", "‡§∂‡•ç‡§∞‡§æ‡§µ‡§£", "‡§≠‡§¶‡•å", "‡§Ö‡§∏‡•ã‡§ú", "‡§ï‡§æ‡§∞‡•ç‡§§‡§ø‡§ï", "‡§Æ‡§Ç‡§∏‡§ø‡§∞", "‡§™‡•Å‡§∑", "‡§Æ‡§æ‡§ò", "‡§´‡§æ‡§≤‡•ç‡§ó‡•Å‡§®", "‡§ö‡•à‡§§‡•ç‡§∞"];
        const nepaliMonthsEng = ["Baisakh", "Jestha", "Ashar", "Shrawan", "Bhadra", "Ashwin", "Kartik", "Mangsir", "Poush", "Magh", "Falgun", "Chaitra"];
        const nepaliNums = ["‡•¶", "‡•ß", "‡•®", "‡•©", "‡•™", "‡•´", "‡•¨", "‡•≠", "‡•Æ", "‡•Ø"];
        const bsMonthDays = [[2000,30,32,31,32,31,30,30,30,29,30,29,31],[2001,31,31,32,31,31,31,30,29,30,29,30,30],[2002,31,31,32,32,31,30,30,29,30,29,30,30],[2003,31,32,31,32,31,30,30,30,29,29,30,31],[2004,30,32,31,32,31,30,30,30,29,30,29,31],[2005,31,31,32,31,31,31,30,29,30,29,30,30],[2006,31,31,32,32,31,30,30,29,30,29,30,30],[2007,31,32,31,32,31,30,30,30,29,29,30,31],[2008,31,31,31,32,31,31,29,30,30,29,29,31],[2009,31,31,32,31,31,31,30,29,30,29,30,30],[2010,31,31,32,32,31,30,30,29,30,29,30,30],[2011,31,32,31,32,31,30,30,30,29,29,30,31],[2012,31,31,31,32,31,31,29,30,30,29,30,30],[2013,31,31,32,31,31,31,30,29,30,29,30,30],[2014,31,31,32,32,31,30,30,29,30,29,30,30],[2015,31,32,31,32,31,30,30,30,29,29,30,31],[2016,31,31,31,32,31,31,29,30,30,29,30,30],[2017,31,31,32,31,31,31,30,29,30,29,30,30],[2018,31,32,31,32,31,30,30,29,30,29,30,30],[2019,31,32,31,32,31,30,30,30,29,30,29,31],[2020,31,31,31,32,31,31,30,29,30,29,30,30],[2021,31,31,32,31,31,31,30,29,30,29,30,30],[2022,31,32,31,32,31,30,30,30,29,29,30,30],[2023,31,32,31,32,31,30,30,30,29,30,29,31],[2024,31,31,31,32,31,31,30,29,30,29,30,30],[2025,31,31,32,31,31,31,30,29,30,29,30,30],[2026,31,32,31,32,31,30,30,30,29,29,30,31],[2027,30,32,31,32,31,30,30,30,29,30,29,31],[2028,31,31,32,31,31,31,30,29,30,29,30,30],[2029,31,31,32,31,32,30,30,29,30,29,30,30],[2030,31,32,31,32,31,30,30,30,29,29,30,31],[2031,30,32,31,32,31,30,30,30,29,30,29,31],[2032,31,31,32,31,31,31,30,29,30,29,30,30],[2033,31,31,32,32,31,30,30,29,30,29,30,30],[2034,31,32,31,32,31,30,30,30,29,29,30,31],[2035,30,32,31,32,31,31,29,30,30,29,29,31],[2036,31,31,32,31,31,31,30,29,30,29,30,30],[2037,31,31,32,32,31,30,30,29,30,29,30,30],[2038,31,32,31,32,31,30,30,30,29,29,30,31],[2039,31,31,31,32,31,31,29,30,30,29,30,30],[2040,31,31,32,31,31,31,30,29,30,29,30,30],[2041,31,31,32,32,31,30,30,29,30,29,30,30],[2042,31,32,31,32,31,30,30,30,29,29,30,31],[2043,31,31,31,32,31,31,29,30,30,29,30,30],[2044,31,31,32,31,31,31,30,29,30,29,30,30],[2045,31,32,31,32,31,30,30,29,30,29,30,30],[2046,31,32,31,32,31,30,30,30,29,29,30,31],[2047,31,31,31,32,31,31,30,29,30,29,30,30],[2048,31,31,32,31,31,31,30,29,30,29,30,30],[2049,31,32,31,32,31,30,30,30,29,29,30,30],[2050,31,32,31,32,31,30,30,30,29,30,29,31],[2051,31,31,31,32,31,31,30,29,30,29,30,30],[2052,31,31,32,31,31,31,30,29,30,29,30,30],[2053,31,32,31,32,31,30,30,30,29,29,30,30],[2054,31,32,31,32,31,30,30,30,29,30,29,31],[2055,31,31,32,31,31,31,30,29,30,29,30,30],[2056,31,31,32,31,32,30,30,29,30,29,30,30],[2057,31,32,31,32,31,30,30,30,29,29,30,31],[2058,30,32,31,32,31,30,30,30,29,30,29,31],[2059,31,31,32,31,31,31,30,29,30,29,30,30],[2060,31,31,32,32,31,30,30,29,30,29,30,30],[2061,31,32,31,32,31,30,30,30,29,29,30,31],[2062,30,32,31,32,31,31,29,30,29,30,29,31],[2063,31,31,32,31,31,31,30,29,30,29,30,30],[2064,31,31,32,32,31,30,30,29,30,29,30,30],[2065,31,32,31,32,31,30,30,30,29,29,30,31],[2066,31,31,31,32,31,31,29,30,30,29,29,31],[2067,31,31,32,31,31,31,30,29,30,29,30,30],[2068,31,31,32,32,31,30,30,29,30,29,30,30],[2069,31,32,31,32,31,30,30,30,29,29,30,31],[2070,31,31,31,32,31,31,29,30,30,29,30,30],[2071,31,31,32,31,31,31,30,29,30,29,30,30],[2072,31,32,31,32,31,30,30,29,30,29,30,30],[2073,31,32,31,32,31,30,30,30,29,29,30,31],[2074,31,31,31,32,31,31,30,29,30,29,30,30],[2075,31,31,32,31,31,31,30,29,30,29,30,30],[2076,31,32,31,32,31,30,30,30,29,29,30,30],[2077,31,32,31,32,31,30,30,30,29,30,29,31],[2078,31,31,31,32,31,31,30,29,30,29,30,30],[2079,31,31,32,31,31,31,30,29,30,29,30,30],[2080,31,32,31,32,31,30,30,30,29,29,30,30],[2081,31,32,31,32,31,30,30,30,29,30,29,31],[2082,31,31,32,31,31,31,30,29,30,29,30,30],[2083,31,31,32,31,32,30,30,29,30,29,30,30],[2084,31,32,31,32,31,30,30,30,29,29,30,31],[2085,30,32,31,32,31,30,30,30,29,30,29,31],[2086,31,31,32,31,31,31,30,29,30,29,30,30],[2087,31,31,32,32,31,30,30,29,30,29,30,30],[2088,31,32,31,32,31,30,30,30,29,29,30,31],[2089,30,32,31,32,31,31,29,30,30,29,29,31],[2090,31,31,32,31,31,31,30,29,30,29,30,30],[2091,31,31,32,32,31,30,30,29,30,29,30,30],[2092,31,32,31,32,31,30,30,30,29,29,30,31],[2093,31,31,31,32,31,31,29,30,30,29,30,30],[2094,31,31,32,31,31,31,30,29,30,29,30,30],[2095,31,32,31,32,31,30,30,29,30,29,30,30],[2096,31,32,31,32,31,30,30,30,29,29,30,31],[2097,31,31,31,32,31,31,30,29,30,29,30,30],[2098,31,31,32,31,31,31,30,29,30,29,30,30],[2099,31,32,31,32,31,30,30,30,29,29,30,30],[2100,31,32,31,32,31,30,30,30,29,30,29,31]];

        // Holidays Data (Month-Day format)
        const holidays = {
            // International Holidays
            "1-1": { name: "New Year's Day", nepali: "‡§®‡§Ø‡§æ‡§Å ‡§µ‡§∞‡•ç‡§∑", type: "International" },
            "2-14": { name: "Valentine's Day", nepali: "‡§≠‡•ç‡§Ø‡§æ‡§≤‡•á‡§®‡•ç‡§ü‡§æ‡§á‡§® ‡§°‡•á", type: "International" },
            "3-8": { name: "Women's Day", nepali: "‡§Æ‡§π‡§ø‡§≤‡§æ ‡§¶‡§ø‡§µ‡§∏", type: "International" },
            "5-1": { name: "Labour Day", nepali: "‡§∂‡•ç‡§∞‡§Æ‡§ø‡§ï ‡§¶‡§ø‡§µ‡§∏", type: "International" },
            "12-25": { name: "Christmas", nepali: "‡§ï‡•ç‡§∞‡§ø‡§∏‡§Æ‡§∏", type: "International" },
            // Nepali Holidays (approximate dates - these vary yearly)
            "1-14": { name: "Makar Sankranti", nepali: "‡§Æ‡§ï‡§∞ ‡§∏‡§Ç‡§ï‡•ç‡§∞‡§æ‡§®‡•ç‡§§‡§ø", type: "Nepal" },
            "2-19": { name: "Democracy Day", nepali: "‡§™‡•ç‡§∞‡§ú‡§æ‡§§‡§®‡•ç‡§§‡•ç‡§∞ ‡§¶‡§ø‡§µ‡§∏", type: "Nepal" },
            "3-8": { name: "Maha Shivaratri", nepali: "‡§Æ‡§π‡§æ‡§∂‡§ø‡§µ‡§∞‡§æ‡§§‡•ç‡§∞‡§ø", type: "Nepal" },
            "3-28": { name: "Holi", nepali: "‡§π‡•ã‡§≤‡•Ä", type: "Nepal" },
            "4-14": { name: "Nepali New Year", nepali: "‡§®‡•á‡§™‡§æ‡§≤‡•Ä ‡§®‡§Ø‡§æ‡§Å ‡§µ‡§∞‡•ç‡§∑", type: "Nepal" },
            "5-29": { name: "Republic Day", nepali: "‡§ó‡§£‡§§‡§®‡•ç‡§§‡•ç‡§∞ ‡§¶‡§ø‡§µ‡§∏", type: "Nepal" },
            "5-23": { name: "Buddha Jayanti", nepali: "‡§¨‡•Å‡§¶‡•ç‡§ß ‡§ú‡§Ø‡§®‡•ç‡§§‡•Ä", type: "Nepal" },
            "9-19": { name: "Constitution Day", nepali: "‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§¶‡§ø‡§µ‡§∏", type: "Nepal" },
            "10-15": { name: "Dashain (Approx)", nepali: "‡§¶‡§∂‡•à‡§Ç", type: "Nepal" },
            "11-1": { name: "Tihar (Approx)", nepali: "‡§§‡§ø‡§π‡§æ‡§∞", type: "Nepal" },
            "11-3": { name: "Bhai Tika (Approx)", nepali: "‡§≠‡§æ‡§á ‡§ü‡•Ä‡§ï‡§æ", type: "Nepal" },
            "12-30": { name: "Udhauli", nepali: "‡§â‡§ß‡•å‡§≤‡•Ä", type: "Nepal" }
        };

        function toNepaliNum(num) { return String(num).split('').map(d => nepaliNums[parseInt(d)] || d).join(''); }
        
        function adToBs(year, month, day) {
            const startAdDate = new Date(1943, 3, 14);
            const inputDate = new Date(year, month - 1, day);
            let totalDays = Math.floor((inputDate - startAdDate) / (1000 * 60 * 60 * 24));
            let bsYear = 2000, bsMonth = 1, bsDay = 1;
            while (totalDays > 0) {
                const yearData = bsMonthDays.find(y => y[0] === bsYear);
                if (!yearData) break;
                const daysInMonth = yearData[bsMonth];
                if (totalDays >= daysInMonth) { totalDays -= daysInMonth; bsMonth++; if (bsMonth > 12) { bsMonth = 1; bsYear++; } }
                else { bsDay = totalDays + 1; totalDays = 0; }
            }
            return { year: bsYear, month: bsMonth, day: bsDay };
        }

        // State
        function getTodayWorkoutDay() { return new Date().getDay() + 1; }

        let currentDay = getTodayWorkoutDay();
        let currentCalendarDate = new Date();
        let completedSets = JSON.parse(localStorage.getItem('completedSets') || '{}');
        let completedDays = JSON.parse(localStorage.getItem('completedDays') || '{}');
        let exerciseWeights = JSON.parse(localStorage.getItem('exerciseWeights') || '{}');
        let creatineTracker = JSON.parse(localStorage.getItem('creatineTracker') || '{}');
        let totalXP = parseInt(localStorage.getItem('totalXP') || '0');
        let weightUnit = localStorage.getItem('weightUnit') || 'lbs';

        // Initialize
        function init() {
            updateDateDisplay();
            renderDayTabs();
            selectDay(getTodayWorkoutDay());
            renderCalendar();
            updateStats();
            updateXPBar();
            updateCreatineButton();
            updateWeightUnitButtons();
        }

        function updateDateDisplay() {
            const now = new Date();
            const dayName = now.toLocaleDateString('en-US', { weekday: 'long' }).toUpperCase();
            const englishDate = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }).toUpperCase();
            const bs = adToBs(now.getFullYear(), now.getMonth() + 1, now.getDate());
            const nepaliDate = toNepaliNum(bs.year) + ' ' + nepaliMonths[bs.month - 1] + ' ' + toNepaliNum(bs.day) + ' ‚Ä¢ ' + nepaliDayNamesFull[now.getDay()];
            document.getElementById('englishDate').textContent = englishDate;
            document.getElementById('dayName').textContent = dayName;
            document.getElementById('nepaliDate').textContent = nepaliDate;
        }

        function renderDayTabs() {
            const container = document.getElementById('dayTabs');
            const todayDay = getTodayWorkoutDay();
            let html = '';
            for (let day = 1; day <= 7; day++) {
                const isToday = day === todayDay;
                const isActive = day === currentDay;
                let classes = 'day-chip';
                if (isActive) classes += ' active';
                if (isToday) classes += ' today';
                html += '<div onclick="selectDay(' + day + ')" class="' + classes + '" data-day="' + day + '">';
                html += '<div class="day-number">' + String(day).padStart(2, '0') + '</div>';
                html += '<div class="day-name">' + shortDayNames[day - 1] + '</div>';
                html += '<div class="day-name-nepali">' + nepaliDayNames[day - 1] + '</div>';
                html += '<div class="day-type">' + workoutTypes[day - 1] + '</div>';
                html += '</div>';
            }
            container.innerHTML = html;
        }

        function showView(view) {
            document.getElementById('workout-view').classList.add('hidden');
            document.getElementById('calendar-view').classList.add('hidden');
            document.getElementById('stats-view').classList.add('hidden');
            document.getElementById(view + '-view').classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('nav-' + view).classList.add('active');
            if (view === 'stats') updateStats();
            if (view === 'calendar') renderCalendar();
        }

        function selectDay(day) {
            currentDay = day;
            renderDayTabs();
            const data = workoutData[day];
            document.getElementById('currentDayTitle').textContent = data.title;
            document.getElementById('currentDayFocus').textContent = data.focus;
            renderExercises();
            updateProgress();
        }

        function getDateKey(date) { 
            date = date || new Date(); 
            return date.getFullYear() + '-' + (date.getMonth() + 1) + '-' + date.getDate(); 
        }

        function renderExercises() {
            const list = document.getElementById('exerciseList');
            const data = workoutData[currentDay];
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            if (!completedSets[dayKey]) completedSets[dayKey] = {};
            if (!exerciseWeights[dayKey]) exerciseWeights[dayKey] = {};
            
            list.innerHTML = data.exercises.map((ex, exIndex) => {
                const exKey = 'ex' + exIndex;
                if (!completedSets[dayKey][exKey]) completedSets[dayKey][exKey] = {};
                
                const completedCount = Object.values(completedSets[dayKey][exKey]).filter(Boolean).length;
                const isCompleted = completedCount === ex.sets;
                const currentWeight = exerciseWeights[dayKey][exKey] || 0;
                
                let setsHtml = '';
                for (let s = 0; s < ex.sets; s++) {
                    const setKey = 'set' + s;
                    const isSetDone = completedSets[dayKey][exKey][setKey] || false;
                    setsHtml += `
                        <div class="set-item">
                            <input type="checkbox" class="set-checkbox" ${isSetDone ? 'checked' : ''} 
                                onchange="toggleSet(${exIndex}, ${s}, this.checked)">
                            <div>
                                <div class="set-label">SET ${s + 1}</div>
                                <div class="set-reps">${ex.reps}</div>
                            </div>
                        </div>
                    `;
                }
                
                return `
                    <div class="exercise-card ${isCompleted ? 'completed' : ''}">
                        <div class="exercise-header">
                            <div class="exercise-info">
                                <span class="muscle-tag">${ex.muscle}</span>
                                <h4 class="exercise-name">${ex.name}</h4>
                                ${ex.note ? `<p class="exercise-note">${ex.note}</p>` : ''}
                            </div>
                        </div>
                        <div class="sets-container">${setsHtml}</div>
                        <div class="weight-input-container">
                            <span class="weight-label">WEIGHT:</span>
                            <div class="weight-controls">
                                <button class="weight-btn" onclick="adjustWeight(${exIndex}, -2.5)">‚àí</button>
                                <div class="weight-display">${currentWeight} ${weightUnit}</div>
                                <button class="weight-btn" onclick="adjustWeight(${exIndex}, 2.5)">+</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function toggleSet(exIndex, setIndex, completed) {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            const exKey = 'ex' + exIndex;
            const setKey = 'set' + setIndex;
            
            if (!completedSets[dayKey]) completedSets[dayKey] = {};
            if (!completedSets[dayKey][exKey]) completedSets[dayKey][exKey] = {};
            
            const wasCompleted = completedSets[dayKey][exKey][setKey];
            completedSets[dayKey][exKey][setKey] = completed;
            localStorage.setItem('completedSets', JSON.stringify(completedSets));
            
            // XP System
            if (completed && !wasCompleted) {
                totalXP += 5;
                localStorage.setItem('totalXP', totalXP);
                updateXPBar();
            } else if (!completed && wasCompleted) {
                totalXP = Math.max(0, totalXP - 5);
                localStorage.setItem('totalXP', totalXP);
                updateXPBar();
            }
            
            renderExercises();
            updateProgress();
            checkDayCompletion();
        }

        function adjustWeight(exIndex, delta) {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            const exKey = 'ex' + exIndex;
            
            if (!exerciseWeights[dayKey]) exerciseWeights[dayKey] = {};
            const current = exerciseWeights[dayKey][exKey] || 0;
            exerciseWeights[dayKey][exKey] = Math.max(0, current + delta);
            localStorage.setItem('exerciseWeights', JSON.stringify(exerciseWeights));
            renderExercises();
        }

        function setWeightUnit(unit) {
            weightUnit = unit;
            localStorage.setItem('weightUnit', unit);
            updateWeightUnitButtons();
            renderExercises();
        }

        function updateWeightUnitButtons() {
            document.getElementById('unitLbs').classList.toggle('active', weightUnit === 'lbs');
            document.getElementById('unitKg').classList.toggle('active', weightUnit === 'kg');
        }

        function toggleCreatine() {
            const dateKey = getDateKey();
            const wasTaken = creatineTracker[dateKey] || false;
            creatineTracker[dateKey] = !creatineTracker[dateKey];
            localStorage.setItem('creatineTracker', JSON.stringify(creatineTracker));
            updateCreatineButton();
            
            // XP System - Add when taken, subtract when untaken
            if (creatineTracker[dateKey] && !wasTaken) {
                // Just took creatine - add XP
                totalXP += 10;
                localStorage.setItem('totalXP', totalXP);
                updateXPBar();
            } else if (!creatineTracker[dateKey] && wasTaken) {
                // Untook creatine - remove XP
                totalXP = Math.max(0, totalXP - 10);
                localStorage.setItem('totalXP', totalXP);
                updateXPBar();
            }
        }

        function updateCreatineButton() {
            const dateKey = getDateKey();
            const btn = document.getElementById('creatineBtn');
            const taken = creatineTracker[dateKey];
            btn.textContent = taken ? '‚úì TAKEN' : 'NOT TAKEN';
            btn.classList.toggle('taken', taken);
        }

        function updateXPBar() {
            const level = Math.floor(totalXP / 100) + 1;
            const currentLevelXP = totalXP % 100;
            const percentage = (currentLevelXP / 100) * 100;
            document.getElementById('userLevel').textContent = level;
            document.getElementById('currentXP').textContent = currentLevelXP;
            document.getElementById('nextLevelXP').textContent = 100;
            document.getElementById('xpFill').style.width = percentage + '%';
        }

        function updateProgress() {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            const exercises = workoutData[currentDay].exercises;
            
            let totalSetsCount = 0;
            let completedCount = 0;
            
            exercises.forEach((ex, exIndex) => {
                totalSetsCount += ex.sets;
                const exKey = 'ex' + exIndex;
                if (completedSets[dayKey] && completedSets[dayKey][exKey]) {
                    completedCount += Object.values(completedSets[dayKey][exKey]).filter(Boolean).length;
                }
            });
            
            const percentage = Math.round((completedCount / totalSetsCount) * 100);
            const circumference = 2 * Math.PI * 34;
            const offset = circumference - (percentage / 100) * circumference;
            document.getElementById('progressCircle').style.strokeDashoffset = offset;
            document.getElementById('progressText').textContent = percentage + '%';
        }

        function checkDayCompletion() {
            const dateKey = getDateKey();
            const dayKey = dateKey + '-day' + currentDay;
            const exercises = workoutData[currentDay].exercises;
            
            let totalSetsCount = 0;
            let completedCount = 0;
            
            exercises.forEach((ex, exIndex) => {
                totalSetsCount += ex.sets;
                const exKey = 'ex' + exIndex;
                if (completedSets[dayKey] && completedSets[dayKey][exKey]) {
                    completedCount += Object.values(completedSets[dayKey][exKey]).filter(Boolean).length;
                }
            });
            
            if (completedCount === totalSetsCount) {
                if (!completedDays[dateKey]) {
                    completedDays[dateKey] = currentDay;
                    localStorage.setItem('completedDays', JSON.stringify(completedDays));
                    totalXP += 50;
                    localStorage.setItem('totalXP', totalXP);
                    updateXPBar();
                }
            }
        }

        function renderCalendar() {
            const grid = document.getElementById('calendarGrid');
            const year = currentCalendarDate.getFullYear();
            const month = currentCalendarDate.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();
            const bs = adToBs(year, month + 1, 15);
            
            document.getElementById('calendarMonth').textContent = new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' }).toUpperCase();
            document.getElementById('calendarNepaliMonth').textContent = nepaliMonthsEng[bs.month - 1] + ' ' + bs.year + ' BS ‚Ä¢ ' + nepaliMonths[bs.month - 1];
            
            let html = '';
            let monthHolidays = [];
            
            for (let i = 0; i < firstDay; i++) html += '<div class="calendar-day" style="opacity: 0;"></div>';
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dateKey = year + '-' + (month + 1) + '-' + day;
                const holidayKey = (month + 1) + '-' + day;
                const isToday = date.toDateString() === today.toDateString();
                const isCompleted = completedDays[dateKey];
                const holiday = holidays[holidayKey];
                const dayOfWeek = date.getDay() + 1;
                const isRestDay = dayOfWeek === 7;
                
                if (holiday) monthHolidays.push({ day, ...holiday });
                
                let classes = 'calendar-day';
                if (isToday) classes += ' today';
                else if (isCompleted) classes += ' completed-day';
                else if (holiday) classes += ' holiday';
                if (!isToday && !isRestDay && !holiday) classes += ' has-workout';
                
                html += `<div class="${classes}" onclick="showDayDetails('${dateKey}')">${day}${holiday ? '<span class="holiday-dot"></span>' : ''}</div>`;
            }
            grid.innerHTML = html;
            
            // Show holidays for this month
            const holidayInfo = document.getElementById('holidayInfo');
            const holidayList = document.getElementById('holidayList');
            if (monthHolidays.length > 0) {
                holidayInfo.classList.add('show');
                holidayList.innerHTML = monthHolidays.map(h => `
                    <div class="holiday-item">
                        <span><span class="holiday-name">${h.day}: ${h.nepali}</span> (${h.name})</span>
                        <span class="holiday-type">${h.type}</span>
                    </div>
                `).join('');
            } else {
                holidayInfo.classList.remove('show');
            }
        }

        function changeMonth(delta) {
            currentCalendarDate.setMonth(currentCalendarDate.getMonth() + delta);
            renderCalendar();
        }

        function showDayDetails(dateKey) {
            console.log('Selected:', dateKey);
        }

        function updateStats() {
            const totalWorkouts = Object.keys(completedDays).length;
            
            let totalSetsCompleted = 0;
            Object.values(completedSets).forEach(day => {
                Object.values(day).forEach(ex => {
                    totalSetsCompleted += Object.values(ex).filter(Boolean).length;
                });
            });
            
            const creatineDays = Object.values(creatineTracker).filter(Boolean).length;
            
            let streak = 0;
            const today = new Date();
            for (let i = 0; i < 365; i++) {
                const checkDate = new Date(today);
                checkDate.setDate(checkDate.getDate() - i);
                const dateKey = getDateKey(checkDate);
                if (completedDays[dateKey]) streak++;
                else if (i > 0) break;
            }
            
            const weekStart = new Date(today);
            weekStart.setDate(weekStart.getDate() - weekStart.getDay());
            
            let weeklyHtml = '';
            for (let i = 0; i < 7; i++) {
                const checkDate = new Date(weekStart);
                checkDate.setDate(checkDate.getDate() + i);
                const dateKey = getDateKey(checkDate);
                const isCompleted = completedDays[dateKey];
                
                weeklyHtml += `
                    <div class="weekly-day">
                        <div class="weekly-day-box ${isCompleted ? 'completed' : ''}">${isCompleted ? '‚úì' : shortDayNames[i][0]}</div>
                        <div class="weekly-day-label">${shortDayNames[i]}</div>
                        <div class="weekly-day-nepali">${nepaliDayNames[i]}</div>
                    </div>
                `;
            }
            document.getElementById('weeklyDays').innerHTML = weeklyHtml;
            
            document.getElementById('totalWorkouts').textContent = totalWorkouts;
            document.getElementById('currentStreak').textContent = streak;
            document.getElementById('totalSets').textContent = totalSetsCompleted;
            document.getElementById('creatineDays').textContent = creatineDays;
        }

        function exportStats() {
            const stats = {
                appName: "Kritik's Gurkha Gains",
                exportDate: new Date().toISOString(),
                totalWorkouts: Object.keys(completedDays).length,
                totalSetsCompleted: 0,
                creatineDaysTaken: Object.values(creatineTracker).filter(Boolean).length,
                totalXP: totalXP,
                level: Math.floor(totalXP / 100) + 1,
                completedDays: completedDays,
                exerciseWeights: exerciseWeights
            };
            
            Object.values(completedSets).forEach(day => {
                Object.values(day).forEach(ex => {
                    stats.totalSetsCompleted += Object.values(ex).filter(Boolean).length;
                });
            });
            
            const dataStr = JSON.stringify(stats, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'gurkha-gains-stats-' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        function resetAllData() {
            if (confirm('‚ö†Ô∏è ‡§Ø‡•ã ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§≤‡•á ‡§§‡§™‡§æ‡§à‡§Ç‡§ï‡•ã ‡§∏‡§¨‡•à ‡§°‡§æ‡§ü‡§æ ‡§Æ‡•á‡§ü‡§æ‡§â‡§®‡•á‡§õ‡•§ Continue?')) {
                localStorage.clear();
                completedSets = {};
                completedDays = {};
                exerciseWeights = {};
                creatineTracker = {};
                totalXP = 0;
                init();
            }
        }

        // PWA Install
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js').catch(function(error) {
                    console.log('ServiceWorker registration failed:', error);
                });
            });
        }
        
        window.addEventListener('beforeinstallprompt', function(e) {
            e.preventDefault();
            deferredPrompt = e;
            const dismissed = localStorage.getItem('installDismissed');
            const dismissedTime = dismissed ? parseInt(dismissed) : 0;
            const daysSinceDismissed = (Date.now() - dismissedTime) / (1000 * 60 * 60 * 24);
            if (daysSinceDismissed > 7) installBanner.classList.remove('hidden');
        });
        
        function installApp() {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then(function() {
                deferredPrompt = null;
                installBanner.classList.add('hidden');
            });
        }
        
        function dismissInstall() {
            installBanner.classList.add('hidden');
            localStorage.setItem('installDismissed', Date.now().toString());
        }

        init();
    </script>
</body>
</html>
